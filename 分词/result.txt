近年来/l ，/w 汽车/n 网络/n 安全/a 攻击/vn 事件/n 频发/v ，/w 而/c 汽车/n 智能化/vn 和/c 网联化/v 所/u 带来/v 的/u 安全/an 隐患/n 也/d 与日俱增/v ，/w 研究/vn 人员/n 除了/p 考虑/v 如何/r 加入/v 防御/vn 措施/n 之外/f ，/w 还/d 应该/v 站在/v 攻击者/n 的/u 角度/n 来/v 分析/v 历史/n 的/u 攻击/vn 事件/n 以及/c 攻击/vn 手段/n 。/w 01/m 汽车/n 信息/n 安全/an 漏洞/n 与/c 攻击/v 针对/p 汽车/n 的/u 攻击/vn 行为/n 在/p 近年来/l 引起/v 了/u 较/d 大/a 的/u 关注/vn ，/w 但是/c 对/p 汽车/n 的/u 攻击/vn 行为/n 却/d 不是/c 近年才/t 有的/r 。/w 早期/f 的/u 攻击/vn 汽车/n 行为/n 主要/d 是/v 破解/v 汽车/n 的/u 防盗/vn 系统/n ，/w 对/p 汽车/n 或/c 车/n 内/f 财产/n 进行/vx 盗窃/vn 。/w 随着/p 智能/n 网联/j 汽车/n 的/u 发展/vn ，/w 汽车/n 具有/v 了/u 更多/d 潜在/v 的/u 入侵/vn 途径/n 。/w 对/p 汽车/n 的/u 攻击/vn 行为/n 包括/v 了/u 汽车/n 非法/b 功能/n 激活/v 、/w 汽车/n 控制/vn 以及/c 隐私/n 盗窃/v 等/u 多种/m 行为/n 。/w 智能/n 网联/j 汽车/n 的/u 环境/n 增加/v 了/u 攻击者/n 入侵/v 的/u 途径/n 和/c 可能性/n 。/w 恶意/n 的/u 攻击者/n 可能/v 会/v 通过/p 夺取/v 汽车/n 的/u 控制权/n 对/p 车主/n 进行/vx 勒索/vn ，/w 也/d 可能/v 在/p 行车/vn 过程/n 中/f 引发/v 安全/an 事故/n ，/w 甚至/d 有/v 可能/n 发动/v 大规模/b 的/u 恐怖/a 袭击/vn 。/w 2011年/t ，/w 德国/ns 马格德堡/ns 大学/n 的/u 研究员/n 针对/p CAN/n 总线/n 网络/n 系统/n ，/w 展示/v 了/u 在/p 车窗/n 升降/v 、/w 汽车/n 警示灯/n 、/w 安全/a 气囊/n 控制/v 以及/c 中央/n 网关/n 控制/vn 系统/n 四/m 种/q 攻击/vn 场景/n 下/f 的/u 安全/an 隐患/n [1]/v 。/w 德国/ns ESCRYPT/nz 公司/n 的/u 研究员/n 提出/v 了/u 在/p 新/a 的/u 网联/j 汽车/n 环境/n 下/f ，/w 需要/v 对/p 汽车/n 内部/f 的/u 数据/n 安全/an 做/v 更/d 好的/a 保护/vn [/n 2]/n 。/w 除此之外/l ，/w 国际/n 上/v 还有/v 很多/m 针对/p 车载/b 网络/n 安全性/n 分析/vn 的/u 研究[/n 3/m ,/q 4]/n 。/w 科恩/nr 实验室/n 在/p 2016年/t 和/c 2017年/t 对/p 特斯拉/ns 汽车/n 实现/v 了无/v 物理/n 接触/vn 攻击/vn 。/w 该/r 安全/an 漏洞/n 可以/v 实现/v 汽车/n 的/u 车身/n 控制/vn 和/c 行车/vn 功能/n 控制/v [/n 5]/v 。/w 在/p 该/r 攻击/vn 案例/n 中/f ，/w 攻击者/n 的/u 入口/n 是/v 中央/n 信息/n 显示/v 模块/n CID/v 。/w 利用/v 这个/r ECU/n 中/f 的/u Linux/vn 操作/vn 系统/n 和/c 浏览器/n 的/u 0/m day/q 漏洞/n 。/w 攻击者/n 成功/a 地/u 实现/v 了/u 通过/p 蜂窝/n 网络/n 从/p 远程/b 接入/v 了/u 信息/n 娱乐/vn 系统/n 。/w 当/p 中央/n 网关/n 被/p 攻破/v 以后/f ，/w 整个/b 车内/s 网络/n 的/u 控制/vn 信号/n 则/c 都/d 暴露/v 在/p 攻击者/n 面前/f 。/w 之后/f 黑客/n 可以/v 通过/p 中央/n 网关/n 发送/v 各类/r CAN/n 总线/n 报文/n 、/w UDS/n 控制/vn 信号/n 等/u ，/w 进而/c 实现/v 对/p 车辆/n 的/u 远程/b 控制/vn 和/c 攻击/v 。/w 2017年/t ，/w 荷兰/ns 网络/n 安全/a 公司/n Computest/v 的/u 研究员/n Daan/v Keuper/n 和/c Thijs/n Alkemade/n 通过/p 对/p 大众/n 和/c 奥迪/nz 的/u 多/a 款/n 车型/n 进行/vx 挖掘/vn ，/w 发现/v 其/r 车载/b 信息/n 娱乐/vn 系统/n 中/f 存在/v 远程/b 利用/vn 漏洞/n [/v 6/m ]/q 。/w 攻击者/n 通过/p 车载/b Wi-Fi/n 设备/n 接入/v 了/u 汽车/n 的/u 信息/n 娱乐/vn 系统/n ，/w 再/d 利用/v 车载/b 信息/n 娱乐/vn 系统/n 的/u 漏洞/n ，/w 向/p CAN/n 总线/n 中/f 发送/v CAN/v 报文/n ，/w 最终/d 实现/v 了/u 对/p 中央/n 屏幕/n 、/w 扬声器/n 和/c 麦克风/n 等/u 装置/n 的/u 控制/vn 。/w 为了/p 解决/v 汽车/n 网络/n 安全/a 问题/n ，/w 汽车/n 厂商/n 在/p 近年来/l 也/d 投入/v 了/u 大量/m 的/u 精力/n 。/w 美国/ns 通用/nz 汽车/n 公司/n 在/p 2016年/t 1月/t 与/p HackerOne/n 合作/v 启动/v 了/u 了/u 公共/b 安全/an 漏洞/n 报告/n 项目/n 。/w 特斯拉/nz 汽车/n 公司/n 、/w 菲亚特克莱斯勒/nz 公司/n 等/u 也/d 在/d BugCrowd/v 的/u 平台/n 上/v 进行/vx 了/u 漏洞/n 悬赏/i ，/w 试图/v 在/p 攻击者/n 利用/v 漏洞/n 进行/vx 攻击/vn 之前/f 发现/v 并/c 解决/v 问题/n 。/w 在/p 美国/ns ，/w 国家/n 公路/n 交通/n 安全/an 管理局/n （/w NHTSA/nr ）/w 近年来/l 一直/d 致力于/v 解决/v 现代/t 汽车/n 网络/n 安全/an 问题/n [/v 7-9]/n 。/w 在/p 日本/ns ，/w 信息/n 处理/vn 推进/vn 机构/n 在/p 2013年/t 发布/v 了/u 汽车/n 网络/n 信息/n 安全/a 指南/n ，/w 提出/v 了/u IPA/n -/n Car/v 安全/an 模型/n [/v 10/m ]/q 。/w 02/m 攻击/vn 案例/n 分析/v 2.1/v 攻击/vn 案例/n 2015年/t 7月/t ，/w 两/m 名/q 美国/ns 白帽/n 黑客/n Chris/v Valasek/n 和/c Charlie/n Miller/n 成功/ad 侵入/v 一/m 辆/q 正在/d 行驶/v 的/u JEEP/n 自由/a 光SUV/n 的/u CAN/vn 总线/n 网络/n 系统/n ，/w 向/p 发动机/n 、/w 变速箱/n 、/w 制动/vn 和/c 转向/n 等/u 系统/n 发送/v 错误/a 指令/n ，/w 最终/d 使/v 这/r 辆/q 车/n 开翻/v 到/v 马路/n 边/n 的/u 斜坡/n 下/f 。/w 随后/d ，/w 他们/r 在/p 8月/n 全球/n 最/d 大/a 的/u 黑客/n 大会/n 上/v ，/w 发布/v 了/u 攻击/vn 细节/n 。/w 该/r 事件/n 直接/ad 导致/v 了/u 克莱斯勒/nz 公司/n 召回/v 了/u 140多万/m 辆/q 汽车/n ，/w 而且/c 该/r 事件/n 也/d 是/v 首起/v 因/p 汽车/n 信息/n 安全/an 问题/n 引发/v 的/u 汽车/n 召回/v 。/w 2.2/n 事件/n 分析/v （/w 1/m ）/w 攻击/v 对象图/n 1/m 攻击/vn 目标/n ——/w 2014/m Jeep/q Cherokee/v 该/r 事件/n 的/u 攻击/vn 目标/n 为/v 2014/m 款/q Jeep/v Cherokee/n ，/w 如图/v 1/m 所/q 示/v 。/w 他们/r 之所以/c 选择/v 这/r 款/n 车/n 作为/v 攻击/vn 目标/n 主要/d 有/v 两/m 方面/n 的/u 原因/n ，/w 一/m 是/v 根据/p 他们/r 之前/f 的/u 一些/m 研究[/n 11/m ]/q ，/w Jeep/v Cherokee/n 相比/v 与/p 其他/r 20/m 款/q 车型/n ，/w 电子/n 电气/n 架构/n 相对/d 简单/a ，/w 侵入/v 到/v 车/n 内/f 总线/n 相对/d 比较/d 容易/a ；/w 二/m 是/v 结合/v 当时/t 他们/r 的/u 成本/n ，/w 最终/d 选择/v 了/u 2014/m 款/q Jeep/v Cherokee/n 。/w 图/n 2/m 2014/m Jeep/q Cherokee/n 车/n 内/f 架构/v 2014/m Jeep/q Cherokee/n 的/u 车/n 内/f 架构/v 非常/d 简单/a ，/w 如图/v 2/m 所/q 示/v ，/w 而/c 最为/d 关键/a 的/u 一点/m 是/v Radio/n 直接/ad 与/p 车/n 内/f 的/u 两/m 个/q CAN/n 总线/n 相连/v ，/w CAN-C/n 和/c CAN/n IHS/n ，/w 而/c CAN-C/v 则/c 是/v 直接/ad 连到/v 车/n 内/f 的/u 动力/n 系统/n 中/f ，/w 比如/v 发动机/n 控制/v 、/w 变速箱/v 换挡/v 控制/v 、/w ABS/v 制动/v 、/w 电子/n 手刹/n 等子/n 系统/n 。/w 那么/c 这样/r 的/u 电子/n 电气/n 架构/n 就/d 意味着/v ，/w 只要/c 侵入/v 了/u 汽车/n 的/u Radio/vn 系统/n ，/w 就/d 能够/v 实现/v 远程/b 控制/vn 汽车/n 。/w 如表/v 1/m 所/q 示/v ，/w 列出/v 了/u Jeep/n Cherokee/n 可能/v 的/u 入侵点/n 。/w 表1/v Jeep/n Cherokee/n 可能/v 的/u 入侵点/n （/w 2/m ）/w 攻击/vn 步骤/n 解析/v 根据/p Chris/n Valasek/n 和/c Charlie/n Miller/n 的/u 研究/vn 报告/n ，/w 将/p 他们/r 的/u 攻击/vn 步骤/n 主要/d 分解/v 为/v 3/m 个/q 步骤/n ：/w ●/w 利用/v 3G/n 伪基站/n 跟/p 汽车/n 通讯/n 模组/n 建立/v 连接/v ，/w 利用/v 通讯/n 端口/v 上/v 开放/a 的/u 后门/n ，/w 获取/v 联网/vn 模块/n 的/u 最/d 高/a 控制/vn 权限/n ；/w ●/w 再/d 通过/p 联网/v 模块/n ，/w 将/d 篡改/v 过/u 的/u 程序/n 刷入/v CAN/n 控制/vn 芯片/n 里/f ，/w 进而/c 实现/v 对/p 车/n 内/f CAN总线/n 的/u 完全/ad 控制/v ；/w ●/w 通过/p CAN/n 控制器/n 给/p 车内/s 其他/r 控制器/n 发送/v 控制/v 指令/n ，/w 实现/v 对/p 车辆/n 的/u 非法/b 操控/vn 。a/n ./v 伪基站/n 连接/v 首先/c ，/w 研究者/n 通过/p 拆解/v 车/n 内/f 的/u T-Box/vn 模块/n ，/w 发现/v 它/r 使用/v 了/u 高通/nr 3G/v 基带/n 芯片/n ，/w 并/c 使用/v Sprint/n 作为/v 运营商/n ，/w 如/v 图/n 3/m 所/q 示/v 。/w 另外/c ，/w 还/d 可以/v 使用/v Sierra/nz 无线/b 软件/n 开发/vn 工具/n 包来/v 开发/vn 和/c 调试/vn 这个/r 系统/n [/v 12/m ]/q 。/w 该/r 车机/n 模块/n 有/v 两/m 个/q 网络/n 接口/n ，/w 一个/m 用于/v 内部/f Wi-Fi/n 通信/vn ，/w 一个/m 通过/p Sprint/v 的/u 3G/vn 服务/vn 与/p 外界/n 通信/vn 。/w 研究者/n 利用/v 伪基站/n ，/w 可以/v 实现/v 手机/n 网络/n 与/p Jeep/n 进行/vx 通信/vn 。/w 图/n 3/m 哈曼Uconnect/nz 系统/n 的/u Sierra/vn Wireless/n AirPrime/v AR5550b/n ./v 网关/n 越狱/v 研究者/n 为了/p 控制/v 车机/n Uconnect/vn 系统/n ，/w 对/p Uconnect/n 将/d 进行/vx 了/u 端口/n 扫描/v ，/w 并/c 发现/v 开放/v 端口/n 6667/m 的/u D-Bus/vn 服务/vn ，/w D/v -/v Bus/v 服务/v 带来/v 的/u 安全/an 风险/n 包括/v 代码/n 注入/v 、/w 功能/n 滥用/v 甚至/d 内存/v 损坏/v 等/u ，/w 因此/c 研究者/n 通过/p D/v -/v Bus/n 服务/vn 可以/v 实现/v 未经/d 身份/n 验证/v 对/p Uconnect/n 系统/n 进行/vx 控制/vn 。/w 然而/c ，/w 车机/n Uconnect/vn 系统/n 并不/d 直接/ad 与/p 车/n 内/f 的/u CAN/n 总线/n 相连/v ，/w 而是/c 通过/p 瑞萨/ns V850ES/n //v FJ3/n 芯片/n 处理/vn 。/w 为了/p 进一步/d 控制/v 车/n 内/f 的/u CAN/n 总线/n 通信/vn ，/w 研究者/n 发现/v V850ES/n 芯片/n 是/v 由/p 车机/n 系统/n 对/p 其/r 进行/vx 固件/n 刷新/v 的/u ，/w 而/c 车机/n 系统/n 之前/f 就/d 拿到/v 了/u 控制权/n ，/w 那么/c 研究者/n 利用/v 修改/v 过/u 的/u 固件/n 重新/d 刷新/v 了/u V850ES/n ，/w 从而/c 将/p 瑞萨/ns V850ES/n //v FJ3/n 芯片/n 进行/vx 了/u 越狱/vn 。/w c/v ./v 非法/d 控制/v 车机/n 芯片/n 和/c CAN/n 控制器/n V850ES/n 通过/p SPI/v 总线/n 进行/vx 连接/vn ，/w 通过/p 使用/v SPI/n 从/p 车机/n 芯片/n 向/p V850ES/n 芯片/n 上/v 修改/v 后/f 的/u 固件/n 发送/v 消息/n ，/w 使得/v V850ES/n 发出/v 控制/vn 车辆/n 行为/n 的/u CAN/vn 数据/n 。/w CAN/n 是/v 一/m 种/q 总线型/b 的/u 协议/n ，/w 在/p 协议/n 中/f 没有/v 原始/a 地址/n 信息/n ，/w 接收/v ECU/n 对/p 收到/v 的/u 数据/n 无法/v 确认/v 是否/v 为/v 原始/a 数据/n ，/w 这就/r 容易/a 导致/v 攻击者/n 通过/p 注入/v 虚假/a 信息/n 对/p CAN/v 总线/n 报文/n 进行/vx 伪造/v 、/w 篡改/v 等/u 。/w 因此/c ，/w 通过/p 逆向JEEP/v 车/n 内/f 的/u CAN/n 通信/vn 协议/n ，/w 就/d 可以/v 进行/vx 伪造/v ，/w 从而/c 进一步/d 控制/v JEEP车/n 的/u CAN-C/vn 总线/n 系统/n 。/w 03/m 总/d 结/v Chalie/v Miller/n 和/c Chris/n Valasek/n 作为/v 黑客/n 突破/v 了/u 以往/t 汽车/n 网络/n 安全/a 黑客/n 的/u 极限/n ，/w 那/c 就是/d 成功/ad 实现/v 了/u 非物理/n 接触/v 下/f 的/u 远程/b 进行/vx 车辆/n 控制/vn 。/w 以往/t 的/u 黑客/n 只能/v 通过/p 物理/n 接触/vn ，/w 或者/c 只能/v 控制/v 单个/b 车辆/n ，/w 最多/d 进行/vx 近/a 距离/n 攻击/v ，/w 而/c Chalie/v 和/c Chris/n 可以/v 控制/v 全美/a 范围/n 内/f ，/w 几乎/d 所有/b 安装/v 了/u Uconnect/n 车机/n 的/u 车/n 。/w 从/p 该/r J/n EEP车/n 攻击/vn 事件/n 的/u 分析/vn 我们/r 也/d 可以/v 看出/v ，/w 实现/v 汽车/n 的/u 远程/b 控制/vn 不是/c 单单/n 通过/p 某/r 一个/m 漏洞/n ，/w 而是/c 通过/p 一系列/l 的/u 漏洞/n 才/d 实现/v 了/u 非物理/n 接触/v 下/v 的/u 入侵/vn ，/w 而/c 另一方面/c 反映/v 出/v 汽车/n 中/f 的/u 各/r 个子/n 控制器/n 存在/v 很多/m 潜在/v 的/u 漏洞/n ，/w 最后/f 再次/d 梳理/v JEEP/v 自由/a 光/n 入侵/v 的/u 时间线/n 作为/v 文章/n 的/u 总结/vn 。/w ●/w 2014年/t 10月/n ：/w Chalie/n 和/c Chris/n 披露/v 了/u D/n -/n Bus/v 服务/v 暴露/v 和/c 易受/v 攻击/v 的/u 事实/n 。/w ●/w 2015年/t 3月/n ：/w Chalie/n 和/c Chris/n 发现/v 可以/v 重新/d 编程/v V850/n 芯片/n ，/w 以/p 从O/v MAP/v 芯片/n 发送/v 任意/d CAN/v 消息/n 。/w ●/w 2015年/t 5月/t 3日/t ：/w Chalie/n 和/c Chris/n 发现/v D/n -/n Bus/n 可以/v 通过/p 蜂窝/n 网络/n 访问/v ，/w 而/c 不仅仅/d 是/v Wi-Fi/n 。/w ●/w 2015年/t 7月/n ：/w Chalie/n 和/c Chris/n 向/p FCA/n 、/w Harman/v Kardon/n 、/w NHTSA/n 和/c QNX/n 提供/v 了/u 研究/vn 报告/n 。/w ●/w 2015年/t 7月/t 16日/t ：/w 克莱斯勒/nz 发布/v 了/u 该/r 问题/n 的/u 补丁/n 。/w ●/w 2015年/t 7月/t 21日/t ：/w 《/w Wired/nr 》/w 文章/n 发布/v 。/w ●/w 2015年/t 7月/t 24日/t ：/w Sprint/v 蜂窝/n 网络/n 阻止/v 端口/n 6667/m 的/u 访问/vn 。/w 克莱斯勒/nz 自愿/v 召回/v 140万/m 辆/q 汽车/n