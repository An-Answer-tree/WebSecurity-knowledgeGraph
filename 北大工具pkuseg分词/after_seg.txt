近年来 ， 汽车 网络 安全 攻击 事件 频发 ， 而 汽车 智能化 和 网联化 所 带来 的 安全 隐患 也 与日俱增 ， 研究 人员 除了 考虑 如何 加入 防御 措施 之外 ， 还 应该 站在 攻击者 的 角度 来 分析 历史 的 攻击 事件 以及 攻击 手段 。 01 汽车 信息 安全 漏洞 与 攻击 针对 汽车 的 攻击 行为 在 近年来 引起 了 较 大 的 关注 ， 但是 对 汽车 的 攻击 行为 却 不是 近年才 有的 。 早期 的 攻击 汽车 行为 主要 是 破解 汽车 的 防盗 系统 ， 对 汽车 或 车 内 财产 进行 盗窃 。 随着 智能 网联 汽车 的 发展 ， 汽车 具有 了 更多 潜在 的 入侵 途径 。 对 汽车 的 攻击 行为 包括 了 汽车 非法 功能 激活 、 汽车 控制 以及 隐私 盗窃 等 多种 行为 。 智能 网联 汽车 的 环境 增加 了 攻击者 入侵 的 途径 和 可能性 。 恶意 的 攻击者 可能 会 通过 夺取 汽车 的 控制权 对 车主 进行 勒索 ， 也 可能 在 行车 过程 中 引发 安全 事故 ， 甚至 有 可能 发动 大规模 的 恐怖 袭击 。 2011年 ， 德国 马格德堡 大学 的 研究员 针对 CAN 总线 网络 系统 ， 展示 了 在 车窗 升降 、 汽车 警示灯 、 安全 气囊 控制 以及 中央 网关 控制 系统 四 种 攻击 场景 下 的 安全 隐患 [1] 。 德国 ESCRYPT 公司 的 研究员 提出 了 在 新 的 网联 汽车 环境 下 ， 需要 对 汽车 内部 的 数据 安全 做 更 好的 保护 [ 2] 。 除此之外 ， 国际 上 还有 很多 针对 车载 网络 安全性 分析 的 研究[ 3 , 4] 。 科恩 实验室 在 2016年 和 2017年 对 特斯拉 汽车 实现 了无 物理 接触 攻击 。 该 安全 漏洞 可以 实现 汽车 的 车身 控制 和 行车 功能 控制 [ 5] 。 在 该 攻击 案例 中 ， 攻击者 的 入口 是 中央 信息 显示 模块 CID 。 利用 这个 ECU 中 的 Linux 操作 系统 和 浏览器 的 0 day 漏洞 。 攻击者 成功 地 实现 了 通过 蜂窝 网络 从 远程 接入 了 信息 娱乐 系统 。 当 中央 网关 被 攻破 以后 ， 整个 车内 网络 的 控制 信号 则 都 暴露 在 攻击者 面前 。 之后 黑客 可以 通过 中央 网关 发送 各类 CAN 总线 报文 、 UDS 控制 信号 等 ， 进而 实现 对 车辆 的 远程 控制 和 攻击 。 2017年 ， 荷兰 网络 安全 公司 Computest 的 研究员 Daan Keuper 和 Thijs Alkemade 通过 对 大众 和 奥迪 的 多 款 车型 进行 挖掘 ， 发现 其 车载 信息 娱乐 系统 中 存在 远程 利用 漏洞 [ 6 ] 。 攻击者 通过 车载 Wi-Fi 设备 接入 了 汽车 的 信息 娱乐 系统 ， 再 利用 车载 信息 娱乐 系统 的 漏洞 ， 向 CAN 总线 中 发送 CAN 报文 ， 最终 实现 了 对 中央 屏幕 、 扬声器 和 麦克风 等 装置 的 控制 。 为了 解决 汽车 网络 安全 问题 ， 汽车 厂商 在 近年来 也 投入 了 大量 的 精力 。 美国 通用 汽车 公司 在 2016年 1月 与 HackerOne 合作 启动 了 了 公共 安全 漏洞 报告 项目 。 特斯拉 汽车 公司 、 菲亚特克莱斯勒 公司 等 也 在 BugCrowd 的 平台 上 进行 了 漏洞 悬赏 ， 试图 在 攻击者 利用 漏洞 进行 攻击 之前 发现 并 解决 问题 。 在 美国 ， 国家 公路 交通 安全 管理局 （ NHTSA ） 近年来 一直 致力于 解决 现代 汽车 网络 安全 问题 [ 7-9] 。 在 日本 ， 信息 处理 推进 机构 在 2013年 发布 了 汽车 网络 信息 安全 指南 ， 提出 了 IPA - Car 安全 模型 [ 10 ] 。 02 攻击 案例 分析 2.1 攻击 案例 2015年 7月 ， 两 名 美国 白帽 黑客 Chris Valasek 和 Charlie Miller 成功 侵入 一 辆 正在 行驶 的 JEEP 自由 光SUV 的 CAN 总线 网络 系统 ， 向 发动机 、 变速箱 、 制动 和 转向 等 系统 发送 错误 指令 ， 最终 使 这 辆 车 开翻 到 马路 边 的 斜坡 下 。 随后 ， 他们 在 8月 全球 最 大 的 黑客 大会 上 ， 发布 了 攻击 细节 。 该 事件 直接 导致 了 克莱斯勒 公司 召回 了 140多万 辆 汽车 ， 而且 该 事件 也 是 首起 因 汽车 信息 安全 问题 引发 的 汽车 召回 。 2.2 事件 分析 （ 1 ） 攻击 对象图 1 攻击 目标 —— 2014 Jeep Cherokee 该 事件 的 攻击 目标 为 2014 款 Jeep Cherokee ， 如图 1 所 示 。 他们 之所以 选择 这 款 车 作为 攻击 目标 主要 有 两 方面 的 原因 ， 一 是 根据 他们 之前 的 一些 研究[ 11 ] ， Jeep Cherokee 相比 与 其他 20 款 车型 ， 电子 电气 架构 相对 简单 ， 侵入 到 车 内 总线 相对 比较 容易 ； 二 是 结合 当时 他们 的 成本 ， 最终 选择 了 2014 款 Jeep Cherokee 。 图 2 2014 Jeep Cherokee 车 内 架构 2014 Jeep Cherokee 的 车 内 架构 非常 简单 ， 如图 2 所 示 ， 而 最为 关键 的 一点 是 Radio 直接 与 车 内 的 两 个 CAN 总线 相连 ， CAN-C 和 CAN IHS ， 而 CAN-C 则 是 直接 连到 车 内 的 动力 系统 中 ， 比如 发动机 控制 、 变速箱 换挡 控制 、 ABS 制动 、 电子 手刹 等子 系统 。 那么 这样 的 电子 电气 架构 就 意味着 ， 只要 侵入 了 汽车 的 Radio 系统 ， 就 能够 实现 远程 控制 汽车 。 如表 1 所 示 ， 列出 了 Jeep Cherokee 可能 的 入侵点 。 表1 Jeep Cherokee 可能 的 入侵点 （ 2 ） 攻击 步骤 解析 根据 Chris Valasek 和 Charlie Miller 的 研究 报告 ， 将 他们 的 攻击 步骤 主要 分解 为 3 个 步骤 ： ● 利用 3G 伪基站 跟 汽车 通讯 模组 建立 连接 ， 利用 通讯 端口 上 开放 的 后门 ， 获取 联网 模块 的 最 高 控制 权限 ； ● 再 通过 联网 模块 ， 将 篡改 过 的 程序 刷入 CAN 控制 芯片 里 ， 进而 实现 对 车 内 CAN总线 的 完全 控制 ； ● 通过 CAN 控制器 给 车内 其他 控制器 发送 控制 指令 ， 实现 对 车辆 的 非法 操控 。a . 伪基站 连接 首先 ， 研究者 通过 拆解 车 内 的 T-Box 模块 ， 发现 它 使用 了 高通 3G 基带 芯片 ， 并 使用 Sprint 作为 运营商 ， 如 图 3 所 示 。 另外 ， 还 可以 使用 Sierra 无线 软件 开发 工具 包来 开发 和 调试 这个 系统 [ 12 ] 。 该 车机 模块 有 两 个 网络 接口 ， 一个 用于 内部 Wi-Fi 通信 ， 一个 通过 Sprint 的 3G 服务 与 外界 通信 。 研究者 利用 伪基站 ， 可以 实现 手机 网络 与 Jeep 进行 通信 。 图 3 哈曼Uconnect 系统 的 Sierra Wireless AirPrime AR5550b . 网关 越狱 研究者 为了 控制 车机 Uconnect 系统 ， 对 Uconnect 将 进行 了 端口 扫描 ， 并 发现 开放 端口 6667 的 D-Bus 服务 ， D - Bus 服务 带来 的 安全 风险 包括 代码 注入 、 功能 滥用 甚至 内存 损坏 等 ， 因此 研究者 通过 D - Bus 服务 可以 实现 未经 身份 验证 对 Uconnect 系统 进行 控制 。 然而 ， 车机 Uconnect 系统 并不 直接 与 车 内 的 CAN 总线 相连 ， 而是 通过 瑞萨 V850ES / FJ3 芯片 处理 。 为了 进一步 控制 车 内 的 CAN 总线 通信 ， 研究者 发现 V850ES 芯片 是 由 车机 系统 对 其 进行 固件 刷新 的 ， 而 车机 系统 之前 就 拿到 了 控制权 ， 那么 研究者 利用 修改 过 的 固件 重新 刷新 了 V850ES ， 从而 将 瑞萨 V850ES / FJ3 芯片 进行 了 越狱 。 c . 非法 控制 车机 芯片 和 CAN 控制器 V850ES 通过 SPI 总线 进行 连接 ， 通过 使用 SPI 从 车机 芯片 向 V850ES 芯片 上 修改 后 的 固件 发送 消息 ， 使得 V850ES 发出 控制 车辆 行为 的 CAN 数据 。 CAN 是 一 种 总线型 的 协议 ， 在 协议 中 没有 原始 地址 信息 ， 接收 ECU 对 收到 的 数据 无法 确认 是否 为 原始 数据 ， 这就 容易 导致 攻击者 通过 注入 虚假 信息 对 CAN 总线 报文 进行 伪造 、 篡改 等 。 因此 ， 通过 逆向JEEP 车 内 的 CAN 通信 协议 ， 就 可以 进行 伪造 ， 从而 进一步 控制 JEEP车 的 CAN-C 总线 系统 。 03 总 结 Chalie Miller 和 Chris Valasek 作为 黑客 突破 了 以往 汽车 网络 安全 黑客 的 极限 ， 那 就是 成功 实现 了 非物理 接触 下 的 远程 进行 车辆 控制 。 以往 的 黑客 只能 通过 物理 接触 ， 或者 只能 控制 单个 车辆 ， 最多 进行 近 距离 攻击 ， 而 Chalie 和 Chris 可以 控制 全美 范围 内 ， 几乎 所有 安装 了 Uconnect 车机 的 车 。 从 该 J EEP车 攻击 事件 的 分析 我们 也 可以 看出 ， 实现 汽车 的 远程 控制 不是 单单 通过 某 一个 漏洞 ， 而是 通过 一系列 的 漏洞 才 实现 了 非物理 接触 下 的 入侵 ， 而 另一方面 反映 出 汽车 中 的 各 个子 控制器 存在 很多 潜在 的 漏洞 ， 最后 再次 梳理 JEEP 自由 光 入侵 的 时间线 作为 文章 的 总结 。 ● 2014年 10月 ： Chalie 和 Chris 披露 了 D - Bus 服务 暴露 和 易受 攻击 的 事实 。 ● 2015年 3月 ： Chalie 和 Chris 发现 可以 重新 编程 V850 芯片 ， 以 从O MAP 芯片 发送 任意 CAN 消息 。 ● 2015年 5月 3日 ： Chalie 和 Chris 发现 D - Bus 可以 通过 蜂窝 网络 访问 ， 而 不仅仅 是 Wi-Fi 。 ● 2015年 7月 ： Chalie 和 Chris 向 FCA 、 Harman Kardon 、 NHTSA 和 QNX 提供 了 研究 报告 。 ● 2015年 7月 16日 ： 克莱斯勒 发布 了 该 问题 的 补丁 。 ● 2015年 7月 21日 ： 《 Wired 》 文章 发布 。 ● 2015年 7月 24日 ： Sprint 蜂窝 网络 阻止 端口 6667 的 访问 。 克莱斯勒 自愿 召回 140万 辆 汽车